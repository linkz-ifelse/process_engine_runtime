const fs = require('fs');
const path = require('path');

const env = process.env.NODE_ENV || 'sqlite';
const storage = process.env.SQLITE_STORAGE;

const userDataFolderPath = require('platform-folders').getConfigHome();
const userDataProcessEngineFolderName = 'process_engine_runtime';
const processEngineDatabaseFolderName = 'databases';

const databaseBasePath = path.join(userDataFolderPath, userDataProcessEngineFolderName, processEngineDatabaseFolderName);

const storagePath = path.join(databaseBasePath, `${storage}.sqlite`);

const sqliteconfig = `{
  "info": "This file is auto generated and required by the sequelize-cli. Please do not remove.",
  "username": null,
  "password": null,
  "database": null,
  "host": null,
  "port": null,
  "dialect": "sqlite",
  "storage": "${storagePath}",
  "supportBigNumbers": true,
  "resetPasswordRequestTimeToLive": 12,
  "logging": false
}`;

fs.writeFileSync('./sequelize/sqlite.json', sqliteconfig, 'utf-8');

module.exports = {
  'config': path.resolve('sequelize', `${env}.json`),
  'migrations-path': path.resolve('sequelize', `migrations/${storage}`)
}
